<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>W2UI Sample (JS Only)</title>
    <link rel="stylesheet" href="/js/w2ui/w2ui-2.0.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .pager {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0 15px;
            flex-wrap: wrap;
        }
        .pager button {
            padding: 6px 10px;
            border: 1px solid #ccc;
            background: #f7f7f7;
            cursor: pointer;
        }
        .pager select,
        .pager input {
            padding: 6px 8px;
            border: 1px solid #ccc;
        }
        .pager .info {
            min-width: 160px;
        }
        .grid-container {
            height: 520px;
        }
        #grid {
            height: 100%;
        }
    </style>
</head>
<body>
    <h1>W2UI Grid Sample (Local Data)</h1>
    <p>No DB, pure JS data. Pagination is handled in JS.</p>

    <div class="grid-container">
        <div id="grid"></div>
    </div>
    <div class="pager">
        <button type="button" id="prevBtn">Prev</button>
        <button type="button" id="nextBtn">Next</button>
        <span class="info" id="pageInfo">Page 1 / 1</span>
        <div id="pageNumbers"></div>
        <label for="pageInput">Go to</label>
        <input type="number" id="pageInput" min="1" value="1" style="width: 80px;">
        <label for="pageSize">Page size</label>
        <select id="pageSize">
            <option value="5">5</option>
            <option value="10" selected>10</option>
            <option value="20">20</option>
            <option value="50">50</option>
        </select>
    </div>
    <script src="/js/jQuery/jquery-3.6.0.min.js"></script>
    <script src="/js/w2ui/w2ui-2.0.min.js"></script>
    <script>
        const records = [];
        for (let i = 1; i <= 57; i++) {
            records.push({
                recid: i,
                empNo: 'E' + String(i).padStart(3, '0'),
                empName: 'User ' + i,
                dept: i % 3 === 0 ? 'Sales' : (i % 3 === 1 ? 'Dev' : 'HR'),
                email: 'user' + i + '@example.com',
                status: i % 2 === 0 ? 'ACTIVE' : 'INACTIVE'
            });
        }

        const grid = $('#grid').w2grid({
            name: 'grid',
            show: {
                footer: true,
                toolbar: false,
                lineNumbers: true,
                selectColumn: true
            },
            multiSelect: true,
            limit: 10,
            total: records.length,
            records: records,
            columns: [
                { field: 'recid', text: 'NO', size: '60px', attr: 'align-center' },
                { field: 'empNo', text: 'Emp No', size: '80px', attr: 'align-center' },
                { field: 'empName', text: 'Name', size: '120px' },
                { field: 'dept', text: 'Dept', size: '80px', attr: 'align-center' },
                { field: 'email', text: 'Email', size: '200px' },
                { field: 'status', text: 'Status', size: '90px', attr: 'align-center' }
            ]
        });

        let pageSize = 10;
        let currentPage = 1;

        function totalPages() {
            return Math.max(1, Math.ceil(records.length / pageSize));
        }

        function renderPage(page) {
            const maxPage = totalPages();
            currentPage = Math.min(Math.max(1, page), maxPage);
            const start = (currentPage - 1) * pageSize;
            const end = start + pageSize;
            const pageRecords = records.slice(start, end);

            grid.records = pageRecords;
            grid.total = records.length;
            grid.limit = pageSize;
            grid.offset = start;
            grid.refresh();

            document.getElementById('pageInfo').textContent = 'Page ' + currentPage + ' / ' + maxPage;
            document.getElementById('pageInput').value = currentPage;
            document.getElementById('prevBtn').disabled = currentPage <= 1;
            document.getElementById('nextBtn').disabled = currentPage >= maxPage;
            renderPageNumbers(maxPage);
        }

        function renderPageNumbers(maxPage) {
            const container = document.getElementById('pageNumbers');
            container.innerHTML = '';
            const windowSize = 5;
            let start = Math.max(1, currentPage - Math.floor(windowSize / 2));
            let end = Math.min(maxPage, start + windowSize - 1);
            start = Math.max(1, end - windowSize + 1);

            for (let p = start; p <= end; p++) {
                const btn = document.createElement('button');
                btn.type = 'button';
                btn.textContent = String(p);
                if (p === currentPage) {
                    btn.disabled = true;
                }
                btn.addEventListener('click', function() {
                    renderPage(p);
                });
                container.appendChild(btn);
            }
        }

        document.getElementById('prevBtn').addEventListener('click', function() {
            renderPage(currentPage - 1);
        });

        document.getElementById('nextBtn').addEventListener('click', function() {
            renderPage(currentPage + 1);
        });

        document.getElementById('pageInput').addEventListener('change', function() {
            const page = parseInt(this.value, 10);
            if (!Number.isNaN(page)) {
                renderPage(page);
            }
        });

        document.getElementById('pageSize').addEventListener('change', function() {
            pageSize = parseInt(this.value, 10);
            renderPage(1);
        });

        renderPage(1);
    </script>
</body>
</html>
